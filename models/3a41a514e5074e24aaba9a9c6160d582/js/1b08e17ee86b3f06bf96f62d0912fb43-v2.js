"use strict";(self.webpackChunksketchfab=self.webpackChunksketchfab||[]).push([[9411],{h0W9:(e,r,o)=>{o.r(r),o.d(r,{default:()=>ee,transferHelpUrl:()=>Y});var t,i,n,a,s,l,d,c,u,v,f,g,m,p=o("D4hk"),Z=o("xKIK"),b=o("Wch8"),h=o("sGMM"),w=o("sQwH"),y=o("y+4b"),j=o.n(y),P=o("3Z9q"),N=o("mSEu"),k=o("YpOo"),O=o("IDtV"),C=o("hK4n"),x=o("e1Pq"),E=o("1bEe"),S=o("xtQ3"),F=o("wpT/"),M=o("mwAa"),V=o("kN3w"),z=o("UzvP"),T=o("vAnt"),A=o("VDcQ"),D=o("+zma"),U=o("wExz"),q=o("RyS8"),I=o("X40V"),K=o("V4X4"),Q=o("FbSi"),R=o("V29b"),_=o("I0q+"),H=o("pgZm"),L=o("2bV5");function W(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,t)}return o}function X(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?W(Object(o),!0).forEach((function(r){(0,Z.Z)(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):W(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}var Y="".concat(N.Z.hosts.faq,"/s/article/Transferring-a-model-from-an-individual-account-into-an-organization-account"),B={org:function(e){var r,o,t=e.model;return{validators:[(0,E.C1)()],initialValue:null!==(r=null===(o=t.org)||void 0===o?void 0:o.uid)&&void 0!==r?r:""}},orgProject:function(){return{validators:[(0,E.C1)("There is no project or folder selected.")],initialValue:void 0}},visibility:function(){return{validators:[(0,E.kw)(["public","private","protected","org"])],initialValue:"org"}},password:function(){return{validators:[function(e,r){return e||"protected"!==r.visibility?void 0:"A password is required for visibility protected."}],initialValue:""}}},G=function(e){var r=e.value,o=e.onChange,t=e.disabled,i=e.filter,n=void 0===i?function(){return!0}:i,a=(0,R.Z)(),s=a.list.filter(n);P.useEffect((function(){s.length&&!r&&o(s[0].org)}),[s,r,o]);var l=P.useMemo((function(){return function(e){return e.map((function(e){return{value:e.org.uid,title:(0,w.Z)("div",{"data-selenium":"option-".concat(e.org.displayName),className:F.Z.orgSelectOption},void 0,(0,w.Z)(_.Z,{alt:"avatar",avatars:e.org.avatars,size:16}),(0,w.Z)("div",{},void 0,e.org.displayName))}}))}(s)}),[s]);return(0,w.Z)(M.U_,{value:r,onChange:function(e){var r=a.list.find((function(r){return r.org.uid===e}));r&&o(r.org)},options:l,pagination:a,disabled:t})},J=function(e){return(0,H.oF)(e.role,"contributor")},$=(0,S.Z)(B);const ee=(0,O.Z)($((function(e){var r=e.popup,o=e.model,y=e.form,N=e.onTransferModelSuccess,O=void 0===N?function(){}:N,E=P.useState(!1),S=(0,h.Z)(E,2),M=S[0],R=S[1],_=(0,x.Z)().Api,H=(0,A.I0)(),W=y.fields.org.value,B=(0,A.v9)(D.wl.authUser.user),$=(0,Q.Z)(W),ee={uid:W,displayName:"",avatars:{uid:"",images:[]},username:"",samlIdpName:""},re=P.useState(o.org||ee),oe=(0,h.Z)(re,2),te=oe[0],ie=oe[1],ne=B.isStaff||"admin"===$,ae=(0,z.Z)(W),se=P.useCallback(function(){var e=(0,b.Z)(j().mark((function e(r){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ae.onReset(),ae.onLoadFirst(),y.fields.orgProject.onChange(r);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[ae,y.fields.orgProject]),le=((0,L.Q)(W,se),P.useCallback((function(e){e.preventDefault(),y.onSubmit(function(){var e=(0,b.Z)(j().mark((function e(t){var i,n,a,s,l,d,c;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.org,a=t.orgProject,s=t.visibility,l=t.password,d=null!==(i=null==a?void 0:a.uid)&&void 0!==i?i:"",e.prev=2,R(!0),!o.org){e.next=11;break}return e.next=7,H(D.Nw.models.orgUpdate(o.uid,{orgProject:d,visibility:s,password:l}));case 7:return e.next=9,H(D.Nw.orgs.invalidateESCache(/^\/i\/orgs\/\w*\/models.*/));case 9:e.next=15;break;case 11:return e.next=13,_.transferModel(o.uid,n,d,s,l);case 13:return e.next=15,H(D.Nw.orgs.invalidateESCache(/^\/i\/me\/models.*/));case 15:return e.next=17,H(D.Nw.messages.add({level:"success",type:"modelTransfer",model:X(X({},o),{},{org:te})}));case 17:R(!1),O(o.uid,d),r.continue(),e.next=28;break;case 22:return e.prev=22,e.t0=e.catch(2),R(!1),c=(0,q.Oe)(e.t0)?(0,q.wp)(e.t0):"The model could not be ".concat(o.org?"moved":"transferred",". Please try again later."),e.next=28,H(D.Nw.messages.add({level:"error",message:c}));case 28:case"end":return e.stop()}}),e,null,[[2,22]])})));return function(r){return e.apply(this,arguments)}}())}),[_,H,y,o.uid,O,r,o]));return(0,w.Z)(k.Z,{className:F.Z.transferPopup,title:o.org?"Move model":"Transfer model",onClose:function(){return r.continue()},footer:(0,w.Z)(P.Fragment,{},void 0,(0,w.Z)("a",{className:F.Z.info,href:Y,target:"_blank",rel:"noopener noreferrer"},void 0,t||(t=(0,w.Z)("i",{className:"icon fa-regular fa-info-circle"})),i||(i=(0,w.Z)("div",{},void 0,"about model transfer"))),(0,w.Z)("div",{className:F.Z.actions},void 0,(0,w.Z)(T.Z,{size:"medium",type:"tertiary",text:"Cancel",onClick:function(){return r.continue()},disabled:M}),(0,w.Z)(T.Z,{size:"medium",type:"primary",text:o.org?"Move":"Transfer",onClick:le,disabled:y.hasErrors||M})))},void 0,(0,w.Z)("div",{className:(0,I.AK)(F.Z.formContent,(0,Z.Z)({},(0,I.c6)(F.Z,"loading"),ae.isLoading))},void 0,(0,w.Z)("div",{className:F.Z.formFields},void 0,o.org?null:(0,w.Z)(P.Fragment,{},void 0,n||(n=(0,w.Z)("div",{},void 0,"Account")),P.createElement(G,(0,p.Z)({},y.fields.org,{onChange:function(e){y.onReset(),te.uid!==e.uid&&ae.onReset(),y.fields.org.onChange(e.uid),ie(e)},disabled:M,filter:J}))),a||(a=(0,w.Z)("div",{},void 0,"Project")),W?(0,w.Z)(V.Z,{className:"c-project-select__dropdown",value:y.fields.orgProject.value,orgUid:W,onChange:function(e){return y.fields.orgProject.onChange(e)}}):s||(s=(0,w.Z)("select",{})),l||(l=(0,w.Z)("div",{},void 0,"Model visibility")),(0,w.Z)(C.Z,{models:[X(X({},o),{},{org:ee})],form:y,disabled:M}),"protected"===y.fields.visibility.value?(0,w.Z)(P.Fragment,{},void 0,d||(d=(0,w.Z)("div",{},void 0,"Password")),P.createElement(K.Z,(0,p.Z)({},y.fields.password,{autoFocus:!0,placeholder:"******",border:!0,type:"password",disabled:M}))):null),(0,w.Z)("div",{className:(0,I.AK)(F.Z.formMessage,(0,Z.Z)({},(0,I.c6)(F.Z,"warning"),y.hasErrors))},void 0,M?(0,w.Z)(P.Fragment,{},void 0,c||(c=(0,w.Z)(U.Z,{})),(0,w.Z)("div",{},void 0,(0,w.Z)("div",{},void 0,(0,w.Z)("b",{},void 0,"Model is being ",o.org?"moved":"transferred",".")),u||(u=(0,w.Z)("div",{},void 0,"You can close this window while you wait.")))):0===ae.list.length?(0,w.Z)(P.Fragment,{},void 0,v||(v=(0,w.Z)("i",{className:"icon fa-regular fa-exclamation-triangle"})),(0,w.Z)("div",{},void 0,"There is no project available to move your model.",f||(f=(0,w.Z)("br",{})),ne?"Please create a project":"Ask your organization admin to create a project.")):y.hasErrors?(0,w.Z)(P.Fragment,{},void 0,g||(g=(0,w.Z)("i",{className:"icon fa-regular fa-exclamation-triangle"})),(0,w.Z)("div",{},void 0,Object.values(y.errors).filter(Boolean).join(".\n"))):o.org?null:m||(m=(0,w.Z)(P.Fragment,{},void 0,(0,w.Z)("i",{className:"icon fa-regular fa-info-circle"}),(0,w.Z)("div",{},void 0,"Please note that the transfer of a model to an organization cannot be canceled."))))))})))}}]);